<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=/images/favicon.png type=image/png><title>Blog 3 :: Báo cáo thực tập</title>
<link href=/css/nucleus.css?1765329835 rel=stylesheet><link href=/css/fontawesome-all.min.css?1765329835 rel=stylesheet><link href=/css/hybrid.css?1765329835 rel=stylesheet><link href=/css/featherlight.min.css?1765329835 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1765329835 rel=stylesheet><link href=/css/auto-complete.css?1765329835 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1765329835 rel=stylesheet><link href=/css/theme.css?1765329835 rel=stylesheet><link href=/css/hugo-theme.css?1765329835 rel=stylesheet><link href=/css/theme-workshop.css?1765329835 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1765329835></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/vi/3-blogstranslated/3.3-blog3/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=/><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1765329835></script><script type=text/javascript src=/js/auto-complete.js?1765329835></script><script type=text/javascript>var baseurl="https://vdhxi.github.io//vi"</script><script type=text/javascript src=/js/search.js?1765329835></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=/vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Worklog Tuần 1" class=dd-item><a href=/vi/1-worklog/1.1-week1/><b>1.1. </b>Worklog Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Worklog Tuần 2" class=dd-item><a href=/vi/1-worklog/1.2-week2/><b>1.2. </b>Worklog Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Worklog Tuần 3" class=dd-item><a href=/vi/1-worklog/1.3-week3/><b>1.3. </b>Worklog Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Worklog Tuần 4" class=dd-item><a href=/vi/1-worklog/1.4-week4/><b>1.4. </b>Worklog Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Worklog Tuần 5" class=dd-item><a href=/vi/1-worklog/1.5-week5/><b>1.5. </b>Worklog Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Worklog Tuần 6" class=dd-item><a href=/vi/1-worklog/1.6-week6/><b>1.6. </b>Worklog Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Worklog Tuần 7" class=dd-item><a href=/vi/1-worklog/1.7-week7/><b>1.7. </b>Worklog Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Worklog Tuần 8" class=dd-item><a href=/vi/1-worklog/1.8-week8/><b>1.8. </b>Worklog Tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Worklog Tuần 9" class=dd-item><a href=/vi/1-worklog/1.9-week9/><b>1.9. </b>Worklog Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Worklog Tuần 10" class=dd-item><a href=/vi/1-worklog/1.10-week10/><b>1.10. </b>Worklog Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Worklog Tuần 11" class=dd-item><a href=/vi/1-worklog/1.11-week11/><b>1.11. </b>Worklog Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Worklog Tuần 12" class=dd-item><a href=/vi/1-worklog/1.12-week12/><b>1.12 </b>Worklog Tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=/vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài Blog đã dịch" class="dd-item
parent"><a href=/vi/3-blogstranslated/><b>3. </b>Các bài Blog đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=/vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=/vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3" class="dd-item
active"><a href=/vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=/vi/3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=/vi/3-blogstranslated/3.5-blog5/><b>3.5. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.6-blog6/ title="Blog 6" class=dd-item><a href=/vi/3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Các events đã tham gia" class=dd-item><a href=/vi/4-eventparticipated/><b>4. </b>Các events đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=/vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=/vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title="Triển khai hệ thống" class=dd-item><a href=/vi/5-workshop/><b>5. </b>Triển khai hệ thống
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-preparation/ title="Chuẩn bị" class=dd-item><a href=/vi/5-workshop/5.1-preparation/><b>5.1 </b>Chuẩn bị
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-preparation/5.1.1-vpc/ title="Tạo VPC" class=dd-item><a href=/vi/5-workshop/5.1-preparation/5.1.1-vpc/><b>5.1.1 </b>Tạo VPC
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.1-preparation/5.1.2-iam/ title="Tạo IAM Role" class=dd-item><a href=/vi/5-workshop/5.1-preparation/5.1.2-iam/><b>5.1.2 </b>Tạo IAM Role
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.2-database-storage/ title="Database & Storage" class=dd-item><a href=/vi/5-workshop/5.2-database-storage/><b>5.2 </b>Database & Storage
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.2-database-storage/5.2.1-rds/ title="Amazon RDS" class=dd-item><a href=/vi/5-workshop/5.2-database-storage/5.2.1-rds/><b>5.2.1 </b>Amazon RDS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-database-storage/5.2.2-elasticache/ title="Amazon ElastiCache" class=dd-item><a href=/vi/5-workshop/5.2-database-storage/5.2.2-elasticache/><b>5.2.2 </b>Amazon ElastiCache
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-database-storage/5.2.3-s3/ title="Amazon S3" class=dd-item><a href=/vi/5-workshop/5.2-database-storage/5.2.3-s3/><b>5.2.3 </b>Amazon S3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.3-compute/ title=Compute class=dd-item><a href=/vi/5-workshop/5.3-compute/><b>5.3 </b>Compute
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.3-compute/5.3.1-ec2/ title="Amazon EC2" class=dd-item><a href=/vi/5-workshop/5.3-compute/5.3.1-ec2/><b>5.3.1 </b>Amazon EC2
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.4-distribution/ title=Distribution class=dd-item><a href=/vi/5-workshop/5.4-distribution/><b>5.4 </b>Distribution
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.4-distribution/5.4.1-ssl-certificate/ title="Certificate Manager" class=dd-item><a href=/vi/5-workshop/5.4-distribution/5.4.1-ssl-certificate/><b>5.4.1 </b>Certificate Manager
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-distribution/5.4.2-alb/ title="Application Load Balancer" class=dd-item><a href=/vi/5-workshop/5.4-distribution/5.4.2-alb/><b>5.4.2 </b>Application Load Balancer
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-distribution/5.4.3-cloudfront/ title="Amazon CloudFront" class=dd-item><a href=/vi/5-workshop/5.4-distribution/5.4.3-cloudfront/><b>5.4.3 </b>Amazon CloudFront
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-distribution/5.4.4-route53/ title="Amazon Route 53" class=dd-item><a href=/vi/5-workshop/5.4-distribution/5.4.4-route53/><b>5.4.4 </b>Amazon Route 53
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.5-deploy/ title=CI/CD class=dd-item><a href=/vi/5-workshop/5.5-deploy/><b>5.5 </b>CI/CD
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.5-deploy/5.5.1-setup-ec2/ title="Cài đặt môi trường EC2 instance" class=dd-item><a href=/vi/5-workshop/5.5-deploy/5.5.1-setup-ec2/><b>5.5.1 </b>Cài đặt môi trường EC2 instance
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.5-deploy/5.5.2-gitlab/ title="GitLab CI" class=dd-item><a href=/vi/5-workshop/5.5-deploy/5.5.2-gitlab/><b>5.5.2 </b>GitLab CI
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.6-cleanup/ title="Dọn dẹp tài nguyên" class=dd-item><a href=/vi/5-workshop/5.6-cleanup/><b>5.6 </b>Dọn dẹp tài nguyên
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=/vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=/vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://vdhxi.github.io/3-blogstranslated/3.3-blog3/>English</option><option id=vi value=https://vdhxi.github.io/vi/3-blogstranslated/3.3-blog3/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/vi/>Báo cáo thực tập</a> > <a href=/vi/3-blogstranslated/>Các bài Blog đã dịch</a> > Blog 3</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#tổng-quan-giải-pháp>Tổng quan giải pháp</a></li><li><a href=#quy-trình-xử-lý-dữ-liệu>Quy trình xử lý dữ liệu</a></li><li><a href=#trích-xuất-dữ-liệu-người-dùng-liên-quan-từ-tài-liệu-pdf>Trích xuất dữ liệu người dùng liên quan từ tài liệu PDF</a></li><li><a href=#gửi-dữ-liệu-người-dùng-đã-trích-xuất-đến-firehose>Gửi dữ liệu người dùng đã trích xuất đến Firehose</a></li><li><a href=#ghi-dữ-liệu-vào-s3-tables-ở-định-dạng-bảng-apache-iceberg>Ghi dữ liệu vào S3 Tables ở định dạng bảng Apache Iceberg</a></li><li><a href=#kết-luận>Kết luận</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 3</h1><h1 id=cách-xuất-dữ-liệu-sang-amazon-s3-tables-bằng-cách-sử-dụng-aws-step-functions-distributed-map>Cách xuất dữ liệu sang Amazon S3 Tables bằng cách sử dụng AWS Step Functions Distributed Map</h1><p>Các công ty chạy khối lượng công việc serverless thường cần thực hiện các hoạt động trích xuất, chuyển đổi và tải (ETL) trên các tệp dữ liệu được lưu trữ trong các bucket <a href=https://aws.amazon.com/s3/>Amazon Simple Storage Service (Amazon S3)</a>. Mặc dù các phương pháp truyền thống như <a href=https://docs.aws.amazon.com/lambda/latest/dg/with-s3.html>AWS Lambda trigger cho Amazon S3</a> hoặc <a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/EventNotifications.html>Amazon S3 Event Notifications</a> có thể xử lý các hoạt động này, chúng có thể không đáp ứng được khi quy trình làm việc yêu cầu khả năng hiển thị, kiểm soát hoặc sự can thiệp của con người nâng cao. Ví dụ, một số quy trình có thể cần xem xét thủ công các bản ghi bị lỗi hoặc phê duyệt rõ ràng trước khi chuyển sang các giai đoạn tiếp theo. Các giải pháp điều phối tùy chỉnh cho những vấn đề này có thể trở nên phức tạp và dễ xảy ra lỗi.</p><p><a href=https://aws.amazon.com/step-functions/>AWS Step Functions</a> giải quyết những thách thức này bằng cách cung cấp khả năng quản lý và giám sát quy trình làm việc tích hợp. Tính năng <a href=https://docs.aws.amazon.com/step-functions/latest/dg/state-map-distributed.html>Step Functions Distributed Map</a> được thiết kế cho các quy trình xử lý dữ liệu song song, thông lượng cao để các công ty có thể xử lý các công việc ETL phức tạp, <a href=https://aws.amazon.com/blogs/aws/new-step-functions-support-for-dynamic-parallelism/>xử lý fan-out</a> và trực quan hóa dữ liệu ở quy mô lớn. Distributed Map xử lý từng mục dữ liệu như một quy trình làm việc con độc lập, xử lý hàng triệu bản ghi trong khi vẫn duy trì các kiểm soát đồng thời tích hợp, khả năng chịu lỗi và theo dõi tiến độ. Dữ liệu đã xử lý có thể được xuất liền mạch đến nhiều đích khác nhau, bao gồm <a href=https://aws.amazon.com/s3/features/tables/>Amazon S3 Tables</a> với hỗ trợ Apache Iceberg.</p><p>Trong bài viết này, chúng tôi chỉ ra cách sử dụng Step Functions Distributed Map để xử lý các đối tượng Amazon S3 và xuất kết quả sang Amazon S3 Tables, tạo ra một đường ống xử lý dữ liệu có thể mở rộng và dễ bảo trì.</p><p>Xem <a href=https://github.com/aws-samples/sample-exporting-to-amazon-s3-tables-with-aws-step-functions-distributed-map>GitHub repository</a> liên quan để biết hướng dẫn chi tiết về việc triển khai giải pháp này cũng như mã mẫu.</p><hr><h2 id=tổng-quan-giải-pháp>Tổng quan giải pháp</h2><p>Hãy xem xét một công ty điện tử tiêu dùng thường xuyên tham gia các triển lãm thương mại và hội nghị trong ngành. Trong các sự kiện này, những người tham dự quan tâm điền vào các biểu mẫu đăng ký bằng giấy để yêu cầu demo sản phẩm, nhận bản tin hoặc tham gia các chương trình truy cập sớm. Sau các sự kiện, đội ngũ của công ty quét hàng trăm nghìn biểu mẫu này và tải chúng lên Amazon S3. Thay vì xem xét thủ công từng biểu mẫu, công ty muốn tự động hóa việc trích xuất các chi tiết khách hàng chính như tên, địa chỉ email, địa chỉ gửi thư và các lĩnh vực quan tâm. Họ muốn lưu trữ dữ liệu có cấu trúc này trong S3 Tables với định dạng Apache Iceberg cho các phân tích downstream và nhắm mục tiêu chiến dịch tiếp thị.</p><p>Hãy xem cách giải pháp của bài viết này sử dụng Distributed Map để xử lý các tệp PDF song song, trích xuất dữ liệu bằng <a href=https://aws.amazon.com/textract/>Amazon Textract</a> và ghi đầu ra đã làm sạch trực tiếp vào S3 Tables. Kết quả là quá trình onboard dữ liệu sau sự kiện có thể mở rộng, không máy chủ, như được hiển thị trong hình sau.</p><p><img src=/images/blog-3/image-1.png></p><p>Quy trình xử lý dữ liệu như được hiển thị trong sơ đồ trước bao gồm các bước sau:</p><ol><li>Người dùng tải các biểu mẫu quan tâm của khách hàng dưới dạng PDF đã quét lên một bucket Amazon S3.</li><li>Một quy tắc <a href=https://docs.aws.amazon.com/eventbridge/latest/userguide/using-eventbridge-scheduler.html>Amazon EventBridge Scheduler</a> kích hoạt theo các khoảng thời gian đều đặn, bắt đầu thực thi quy trình làm việc Step Functions.</li><li>Việc thực thi quy trình làm việc kích hoạt trạng thái Step Functions Distributed Map, liệt kê tất cả các tệp PDF đã tải lên Amazon S3 kể từ lần chạy trước.</li><li>Distributed Map lặp qua danh sách các đối tượng và chuyển metadata của từng đối tượng (<a href=https://docs.aws.amazon.com/AmazonS3/latest/API/API_Object.html>bucket, key, size, entity tag [ETag]</a>) cho một thực thi quy trình làm việc con.</li><li>Đối với mỗi đối tượng, quy trình làm việc con gọi Amazon Textract với bucket và key được cung cấp để trích xuất văn bản thô và các trường liên quan (tên, địa chỉ email, địa chỉ gửi thư, lĩnh vực quan tâm) từ PDF.</li><li>Quy trình làm việc con gửi dữ liệu đã trích xuất đến <a href=https://aws.amazon.com/firehose/>Amazon Data Firehose</a>, được cấu hình để chuyển tiếp dữ liệu đến S3 Tables.</li><li>Firehose phân lô dữ liệu đến từ quy trình làm việc con và ghi nó vào S3 Tables theo khoảng thời gian được cấu hình trước mà bạn chọn.</li></ol><p>Với dữ liệu hiện đã được cấu trúc và có thể truy cập trong S3 Tables, người dùng có thể dễ dàng phân tích chúng bằng các truy vấn SQL tiêu chuẩn với <a href=https://aws.amazon.com/athena/>Amazon Athena</a> hoặc trí tuệ doanh nghiệp như <a href=https://aws.amazon.com/quicksight/>Amazon QuickSight</a>.</p><h2 id=quy-trình-xử-lý-dữ-liệu>Quy trình xử lý dữ liệu</h2><p>EventBridge Scheduler bắt đầu các quy trình làm việc Step Functions mới theo các khoảng thời gian đều đặn. Dòng thời gian cho lịch trình này rất linh hoạt. Tuy nhiên, khi thiết lập lịch trình của bạn, hãy đảm bảo tần suất phù hợp với khoảng thời gian mà state machine của bạn được cấu hình để tìm kiếm các tệp PDF. Ví dụ: nếu state machine của bạn kiểm tra các tệp PDF từ tuần trước, bạn sẽ muốn lên lịch chạy hàng tuần. Quy trình làm việc Step Functions sau đó thực hiện ba bước sau (lưu ý rằng các bước này là các bước 4, 5, 6 và 7 trong sơ đồ quy trình làm việc trước đó):</p><ol><li>Trích xuất dữ liệu người dùng liên quan từ các tệp PDF.</li><li>Gửi dữ liệu người dùng đã trích xuất đến Firehose.</li><li>Ghi dữ liệu vào S3 Tables ở định dạng bảng Apache Iceberg.</li></ol><p>Sơ đồ sau minh họa quy trình làm việc này.</p><p><img src=/images/blog-3/image-2.png></p><p>Hãy xem xét từng bước của quy trình làm việc trước đó chi tiết hơn.</p><h2 id=trích-xuất-dữ-liệu-người-dùng-liên-quan-từ-tài-liệu-pdf>Trích xuất dữ liệu người dùng liên quan từ tài liệu PDF</h2><p>Step Functions sử dụng Distributed Map để xử lý các tệp PDF đồng thời trong các quy trình làm việc con song song. Nó chấp nhận đầu vào từ <a href=https://aws.amazon.com/documentdb/what-is-json/>JSON</a>, <a href=https://jsonlines.org/>JSONL</a>, CSV, tệp Parquet, tệp kê khai Amazon S3 được lưu trữ trong Amazon S3 (được sử dụng để chỉ định các tệp cụ thể để xử lý) hoặc <a href=https://docs.aws.amazon.com/firehose/latest/dev/dynamic-partitioning-s3bucketprefix.html>Amazon S3 bucket prefix</a> (cho phép lặp qua metadata tệp cho tất cả các đối tượng dưới prefix đó). Step Functions tự động xử lý việc song song hóa bằng cách chia nhỏ tập dữ liệu và chạy các quy trình làm việc con cho từng mục, với trường <a href=https://docs.aws.amazon.com/step-functions/latest/dg/input-output-itembatcher.html>ItemBatcher</a> cho phép nhóm nhiều tệp PDF vào một lần thực thi quy trình làm việc con duy nhất (ví dụ: 10 tệp PDF mỗi lô) để tối ưu hóa hiệu suất và chi phí.</p><p>Ảnh chụp màn hình sau của bảng điều khiển Step Functions hiển thị cấu hình cho Distributed Map. Ví dụ: chúng tôi đã cấu hình Distributed Map để xử lý 10 tệp PDF quan tâm của khách hàng trong một quy trình làm việc con duy nhất.</p><p><img src=/images/blog-3/image-3.png></p><p>Hình ảnh sau đây hiển thị một ví dụ về các tệp PDF được quét này, bao gồm thông tin khách hàng mà giải pháp của bài viết này xử lý.</p><p><img src=/images/blog-3/image-4.png></p><p>Mỗi quy trình làm việc con sau đó gọi <a href=https://docs.aws.amazon.com/textract/latest/dg/API_AnalyzeDocument.html>Amazon Textract AnalyzeDocument API</a> với các truy vấn cụ thể để trích xuất thông tin khách hàng.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;Document&#34;: {
</span></span><span style=display:flex><span>    &#34;S3Object&#34;: {
</span></span><span style=display:flex><span>      &#34;Bucket&#34;: &#34;&lt;input PDFs bucket&gt;&#34;,
</span></span><span style=display:flex><span>      &#34;Name&#34;: &#34;{% $states.input.Key %}&#34;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  &#34;FeatureTypes&#34;: [
</span></span><span style=display:flex><span>    &#34;QUERIES&#34;
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  &#34;QueriesConfig&#34;: {
</span></span><span style=display:flex><span>    &#34;Queries&#34;: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;Alias&#34;: &#34;full_name&#34;,
</span></span><span style=display:flex><span>        &#34;Text&#34;: &#34;What is the customer&#39;s name?&#34;
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;Alias&#34;: &#34;phone_number&#34;,
</span></span><span style=display:flex><span>        &#34;Text&#34;: &#34;What is the customer’s phone number?&#34;
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;Alias&#34;: &#34;mailing_address&#34;,
</span></span><span style=display:flex><span>        &#34;Text&#34;: &#34;What is the customer’s mailing address?&#34;
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        &#34;Alias&#34;: &#34;interest&#34;,
</span></span><span style=display:flex><span>        &#34;Text&#34;: &#34;What is the customer’s interest?&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>API phân tích từng tệp PDF được quét và trả về cấu trúc JSON chứa thông tin khách hàng đã trích xuất.</p><h2 id=gửi-dữ-liệu-người-dùng-đã-trích-xuất-đến-firehose>Gửi dữ liệu người dùng đã trích xuất đến Firehose</h2><p>Quy trình làm việc con sau đó sử dụng <a href=https://docs.aws.amazon.com/firehose/latest/APIReference/API_PutRecordBatch.html>hành động Firehose PutRecordBatch API</a> với <a href=https://docs.aws.amazon.com/step-functions/latest/dg/integrate-services.html>tích hợp dịch vụ</a> để xếp hàng thông tin khách hàng đã trích xuất để xử lý thêm. Yêu cầu hành động PutRecordBatch bao gồm tên luồng Firehose và các bản ghi dữ liệu. Các bản ghi dữ liệu bao gồm một blob dữ liệu từ bước 1 chứa thông tin khách hàng đã trích xuất, như được hiển thị trong ví dụ sau.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;DeliveryStreamName&#34;: &#34;put_raw_form_data_100&#34;,
</span></span><span style=display:flex><span>  &#34;Records&#34;: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;Data&#34;: &#34;{\&#34;full_name\&#34;:\&#34;Anthony Ayala\&#34;,\&#34;phone_number\&#34;:\&#34;001-384-925-0701\&#34;,\&#34;mailing_address\&#34;:\&#34;38548 Joshua Wall Suite 974, East Heatherfort, OH 32669\&#34;,\&#34;interest\&#34;:\&#34;Fitness Trackers\&#34;,\&#34;processed_date\&#34;:\&#34;2025-05-01\&#34;}&#34;
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;Data&#34;: &#34;{\&#34;full_name\&#34;:\&#34;Becky Williams\&#34;,\&#34;phone_number\&#34;:\&#34;+1-283-499-2466\&#34;,\&#34;mailing_address\&#34;:\&#34;227 King Forge Suite 241, East Nathanland, PR 05687\&#34;,\&#34;interest\&#34;:\&#34;Al Assistants\&#34;,\&#34;processed_date\&#34;:\&#34;2025-05-01\&#34;}&#34;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=ghi-dữ-liệu-vào-s3-tables-ở-định-dạng-bảng-apache-iceberg>Ghi dữ liệu vào S3 Tables ở định dạng bảng Apache Iceberg</h2><p>Firehose quản lý hiệu quả việc đệm dữ liệu, chuyển đổi định dạng và phân phối đáng tin cậy đến nhiều đích khác nhau, bao gồm Apache Iceberg, tệp thô trong Amazon S3, <a href=https://aws.amazon.com/opensearch-service/>Amazon OpenSearch Service</a>, hoặc <a href=https://docs.aws.amazon.com/firehose/latest/dev/create-destination.html>bất kỳ đích nào khác được hỗ trợ</a>. Các bảng Apache Iceberg có thể được tự quản lý trong Amazon S3 hoặc được lưu trữ trong S3 Tables. Mặc dù các bảng Iceberg tự quản lý yêu cầu tối ưu hóa thủ công—chẳng hạn như nén và hết hạn snapshot—S3 Tables tự động tối ưu hóa lưu trữ cho khối lượng công việc phân tích quy mô lớn, cải thiện hiệu suất truy vấn và giảm chi phí lưu trữ.</p><p>Firehose đơn giản hóa quá trình truyền dữ liệu bằng cách cấu hình luồng phân phối, chọn nguồn dữ liệu và đặt bảng Iceberg làm đích. Sau khi bạn thiết lập xong, luồng Firehose đã sẵn sàng để phân phối dữ liệu. Dữ liệu được phân phối có thể được truy vấn từ S3 Tables bằng cách sử dụng Athena, như được hiển thị trong ảnh chụp màn hình sau của bảng điều khiển Athena.</p><p><img src=/images/blog-3/image-5.png></p><p>Kết quả truy vấn bao gồm tất cả dữ liệu khách hàng đã xử lý từ các tệp PDF, như được hiển thị trong ảnh chụp màn hình sau.</p><p><img src=/images/blog-3/image-6.png></p><p>Sự tích hợp này thể hiện một giải pháp mạnh mẽ, không cần mã để chuyển đổi các biểu mẫu PDF thô thành dữ liệu có thể truy vấn, phong phú trong bảng Iceberg. Bạn có thể sử dụng dữ liệu này để phân tích thêm.</p><h2 id=kết-luận>Kết luận</h2><p>Trong bài viết này, chúng tôi đã chỉ ra cách xây dựng một giải pháp có thể mở rộng, không máy chủ để xử lý tài liệu PDF và xuất dữ liệu đã trích xuất sang S3 Tables bằng cách sử dụng Step Functions Distributed Map. Kiến trúc này mang lại một số lợi ích chính như độ tin cậy, hiệu quả chi phí, khả năng hiển thị và khả năng bảo trì. Bằng cách tận dụng các dịch vụ AWS như Step Functions, Amazon Textract, Firehose và S3 Tables, các công ty có thể tự động hóa quy trình xử lý tài liệu của họ trong khi đảm bảo hiệu suất tối ưu và sự xuất sắc trong vận hành. Giải pháp này có thể được điều chỉnh cho nhiều trường hợp sử dụng khác ngoài các biểu mẫu quan tâm của khách hàng, chẳng hạn như xử lý hóa đơn, biểu mẫu đăng ký hoặc bất kỳ kịch bản nào yêu cầu trích xuất dữ liệu có cấu trúc từ tài liệu ở quy mô lớn.</p><p>Mặc dù ví dụ này tập trung vào việc xử lý dữ liệu PDF và ghi vào S3 Tables, Distributed Map có thể xử lý nhiều nguồn đầu vào khác nhau bao gồm JSON, JSONL, CSV và tệp Parquet trong Amazon S3; các mục trong bảng <a href=https://aws.amazon.com/dynamodb/>Amazon DynamoDB</a>; kết quả truy vấn Athena; và tất cả các AWS List API được phân trang. Tương tự, thông qua <a href=https://docs.aws.amazon.com/step-functions/latest/dg/integrate-services.html>tích hợp dịch vụ Step Functions</a>, bạn có thể ghi kết quả đến nhiều đích như <a href=https://docs.aws.amazon.com/step-functions/latest/dg/connect-ddb.html>bảng DynamoDB bằng cách sử dụng tích hợp dịch vụ PutItem</a>.</p><p>Để bắt đầu với giải pháp này, hãy xem <a href=https://github.com/aws-samples/sample-exporting-to-amazon-s3-tables-with-aws-step-functions-distributed-map>GitHub repository</a> liên quan để biết hướng dẫn triển khai và mã mẫu.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/vi/3-blogstranslated/3.4-blog4/ title="Blog 4" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1765329835></script><script src=/js/perfect-scrollbar.min.js?1765329835></script><script src=/js/perfect-scrollbar.jquery.min.js?1765329835></script><script src=/js/jquery.sticky.js?1765329835></script><script src=/js/featherlight.min.js?1765329835></script><script src=/js/highlight.pack.js?1765329835></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1765329835></script><script src=/js/learn.js?1765329835></script><script src=/js/hugo-learn.js?1765329835></script><link href=/mermaid/mermaid.css?1765329835 rel=stylesheet><script src=/mermaid/mermaid.js?1765329835></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>