<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=/images/favicon.png type=image/png><title>Blog 2 :: Internship Report</title>
<link href=/css/nucleus.css?1765329835 rel=stylesheet><link href=/css/fontawesome-all.min.css?1765329835 rel=stylesheet><link href=/css/hybrid.css?1765329835 rel=stylesheet><link href=/css/featherlight.min.css?1765329835 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1765329835 rel=stylesheet><link href=/css/auto-complete.css?1765329835 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1765329835 rel=stylesheet><link href=/css/theme.css?1765329835 rel=stylesheet><link href=/css/hugo-theme.css?1765329835 rel=stylesheet><link href=/css/theme-workshop.css?1765329835 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1765329835></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/3-blogstranslated/3.2-blog2/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=/><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1765329835></script><script type=text/javascript src=/js/auto-complete.js?1765329835></script><script type=text/javascript>var baseurl="https://vdhxi.github.io/"</script><script type=text/javascript src=/js/search.js?1765329835></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=/1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Worklog Week 1" class=dd-item><a href=/1-worklog/1.1-week1/><b>1.1. </b>Worklog Week 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Worklog Week 2" class=dd-item><a href=/1-worklog/1.2-week2/><b>1.2. </b>Worklog Week 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Worklog Week 3" class=dd-item><a href=/1-worklog/1.3-week3/><b>1.3. </b>Worklog Week 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Worklog Week 4" class=dd-item><a href=/1-worklog/1.4-week4/><b>1.4. </b>Worklog Week 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Worklog Week 5" class=dd-item><a href=/1-worklog/1.5-week5/><b>1.5. </b>Worklog Week 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Worklog Week 6" class=dd-item><a href=/1-worklog/1.6-week6/><b>1.6. </b>Worklog Week 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Worklog Week 7" class=dd-item><a href=/1-worklog/1.7-week7/><b>1.7. </b>Worklog Week 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Worklog Week 8" class=dd-item><a href=/1-worklog/1.8-week8/><b>1.8. </b>Worklog Week 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Worklog Week 9" class=dd-item><a href=/1-worklog/1.9-week9/><b>1.9. </b>Worklog Week 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Worklog Week 10" class=dd-item><a href=/1-worklog/1.10-week10/><b>1.10. </b>Worklog Week 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Worklog Week 11" class=dd-item><a href=/1-worklog/1.11-week11/><b>1.11. </b>Worklog Week 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Worklog Week 12" class=dd-item><a href=/1-worklog/1.12-week12/><b>1.12 </b>Worklog Week 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=/2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=/3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class="dd-item
active"><a href=/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=/3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=/3-blogstranslated/3.5-blog5/><b>3.5. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.6-blog6/ title="Blog 6" class=dd-item><a href=/3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=/4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=/4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=/4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title="System Deployment" class=dd-item><a href=/5-workshop/><b>5. </b>System Deployment
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-preparation/ title=Preparation class=dd-item><a href=/5-workshop/5.1-preparation/><b>5.1 </b>Preparation
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-preparation/5.1.1-vpc/ title="Create VPC" class=dd-item><a href=/5-workshop/5.1-preparation/5.1.1-vpc/><b>5.1.1 </b>Create VPC
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.1-preparation/5.1.2-iam/ title="Create IAM Role" class=dd-item><a href=/5-workshop/5.1-preparation/5.1.2-iam/><b>5.1.2 </b>Create IAM Role
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.2-database-storage/ title="Database & Storage" class=dd-item><a href=/5-workshop/5.2-database-storage/><b>5.2 </b>Database & Storage
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.2-database-storage/5.2.1-rds/ title="Amazon RDS" class=dd-item><a href=/5-workshop/5.2-database-storage/5.2.1-rds/><b>5.2.1 </b>Amazon RDS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-database-storage/5.2.2-elasticache/ title="Amazon ElastiCache" class=dd-item><a href=/5-workshop/5.2-database-storage/5.2.2-elasticache/><b>5.2.2 </b>Amazon ElastiCache
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-database-storage/5.2.3-s3/ title="Amazon S3" class=dd-item><a href=/5-workshop/5.2-database-storage/5.2.3-s3/><b>5.2.3 </b>Amazon S3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.3-compute/ title=Compute class=dd-item><a href=/5-workshop/5.3-compute/><b>5.3 </b>Compute
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-compute/5.3.1-ec2/ title="Amazon EC2" class=dd-item><a href=/5-workshop/5.3-compute/5.3.1-ec2/><b>5.3.1 </b>Amazon EC2
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-distribution/ title=Distribution class=dd-item><a href=/5-workshop/5.4-distribution/><b>5.4 </b>Distribution
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.4-distribution/5.4.1-ssl-certificate/ title="Certificate Manager" class=dd-item><a href=/5-workshop/5.4-distribution/5.4.1-ssl-certificate/><b>5.4.1 </b>Certificate Manager
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-distribution/5.4.2-alb/ title="Application Load Balancer" class=dd-item><a href=/5-workshop/5.4-distribution/5.4.2-alb/><b>5.4.2 </b>Application Load Balancer
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-distribution/5.4.3-cloudfront/ title="Amazon CloudFront" class=dd-item><a href=/5-workshop/5.4-distribution/5.4.3-cloudfront/><b>5.4.3 </b>Amazon CloudFront
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-distribution/5.4.4-route53/ title="Amazon Route 53" class=dd-item><a href=/5-workshop/5.4-distribution/5.4.4-route53/><b>5.4.4 </b>Amazon Route 53
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.5-deploy/ title=CI/CD class=dd-item><a href=/5-workshop/5.5-deploy/><b>5.5 </b>CI/CD
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.5-deploy/5.5.2-gitlab/ title="GitLab CI" class=dd-item><a href=/5-workshop/5.5-deploy/5.5.2-gitlab/><b>5.5.2 </b>GitLab CI
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-deploy/5.5.1-setup-ec2/ title="Setup EC2 Instance Environment" class=dd-item><a href=/5-workshop/5.5-deploy/5.5.1-setup-ec2/><b>5.5.1 </b>Setup EC2 Instance Environment
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Clean Up" class=dd-item><a href=/5-workshop/5.6-cleanup/><b>5.6 </b>Clean Up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-evaluation class=dd-item><a href=/6-self-evaluation/><b>6. </b>Self-evaluation
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=/7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://vdhxi.github.io/3-blogstranslated/3.2-blog2/ selected>English</option><option id=vi value=https://vdhxi.github.io/vi/3-blogstranslated/3.2-blog2/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Internship Report</a> > <a href=/3-blogstranslated/>Translated Blogs</a> > Blog 2</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#feature-overview>Feature overview</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#deriving-insights-from-the-amazon-ec2-instance-store-nvme-detailed-performance-statistics>Deriving insights from the Amazon EC2 instance store NVMe detailed performance statistics</a><ul><li><a href=#scenario-1-identifying-when-applications-exceed-instance-storage-performance-limits>Scenario 1: Identifying when applications exceed instance storage performance limits</a></li><li><a href=#scenario-2-identifying-the-block-size-causing-elevated-latency-in-your-applications>Scenario 2: Identifying the block size causing elevated latency in your applications</a></li></ul></li><li><a href=#clean-up>Clean up</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 2</h1><h1 id=optimize-latency-sensitive-workloads-with-amazon-ec2-detailed-nvme-statistics>Optimize latency-sensitive workloads with Amazon EC2 detailed NVMe statistics</h1><p>Amazon Elastic Cloud Compute (Amazon EC2) instances with locally attached NVMe storage can provide the performance needed for workloads demanding ultra-low latency and high I/O throughput. High-performance workloads, from high-frequency trading applications and in-memory databases to real-time analytics engines and AI/ML inference, need comprehensive performance tracking. Operating system tools like iostat and sar provide valuable system-level insights, and Amazon CloudWatch offers important disk IOPs and throughput measurements, but high-performance workloads can benefit from even more detailed visibility into instance store performance.</p><p>For latency-sensitive applications where every millisecond counts, enhanced performance monitoring tools provide deep visibility into storage systems, so your teams can track and analyze behavior at a 1 second granularity. This detailed insight can help your organization detect bottlenecks quickly, fine-tune application performance, and deliver reliable service.</p><p>In this post, we discuss how you can use Amazon EC2 detailed performance statistics for instance store NVMe volumes, a set of new metrics that provide per-second granularity, to provide real-time visibility into your locally attached storage performance. These statistics are similar to the Amazon EBS detailed performance statistics, providing a consistent monitoring experience across both storage types. You can access these statistics directly from your NVMe devices attached to the Amazon EC2 instance using nvme-cli or using CloudWatch agent to monitor I/O performance at the storage level. We also provide examples of how to use these statistics to identify performance bottlenecks.</p><h2 id=feature-overview>Feature overview</h2><p>Amazon EC2 Nitro-based instances with locally attached NVMe instance storage now offer 11 comprehensive metrics at per-second granularity. These metrics, similar to EBS volume metrics, include queue length measurements, IOPS, throughput data, and IO latency histograms for the locally attached NVMe instance storage. Additionally, they also include IO size-specific latency histograms to provide even more detailed insights into performance patterns of the local NVMe instance storage. These metrics are collected and presented separately for each individual NVMe volume available on an instance.</p><p>The statistics are presented in three main formats:</p><ol><li>The statistics are presented in three main formats:</li><li>Real-time queue length, displaying the current value at the time of your query</li><li>Latency histograms visualizing the distribution of IO operations across different latency ranges by displaying both cumulative view and IO size-specific distributions</li></ol><h2 id=prerequisites>Prerequisites</h2><p>To access detailed performance statistics for local instance storage, complete the following steps:</p><ol><li>Launch a new Amazon EC2 Nitro instance or use an existing one, then connect to it using SSH or your preferred connection method.</li><li>Identify the NVMe device associated with the local storage to query for the performance statistics. For example, you can run the <code>nvme-cli</code> command in the CLI to output all NVMe devices on the instance.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  bash
</span></span><span style=display:flex><span>  $ sudo nvme list.
</span></span></code></pre></div><p>The following is an example output of the list command that lists the NVMe devices on the instance and their volume Serial Numbers (SN; masked in the below output for privacy). In this demonstration, consider that the local storage used by your application is <code>/dev/nvme1n1</code>.</p><p><img src=/images/blog-2/image-1.png></p><ol start=3><li>If you are using Amazon Linux 2023 version 2023.8.20250915 (or later) or Amazon Linux 2 2.0.20251014.0 (or later) you can proceed to Step 4 because <code>nvme-cli</code> will use the latest version. If you are using an earlier Amazon Linux version, update the <code>nvme-cli</code> using the following command, where <code>2023.8.20250915</code> can be replaced with the latest Amazon Linux 2023 version:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  bash
</span></span><span style=display:flex><span>  $ sudo dnf upgrade --releasever=2023.8.20250915
</span></span></code></pre></div><ol start=4><li>Run the <code>nvme-cli</code>, with the correct permissions, and pass the device as a parameter. You can use <code>--help</code> to get details on the command usage:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  bash
</span></span><span style=display:flex><span>  $ sudo nvme amzn stats --help
</span></span></code></pre></div><p>Example output:</p><p><img src=/images/blog-2/image-2.png></p><p>If you prefer output in a JSON format, you can provide the <code>-o json</code> parameter to the command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  bash
</span></span><span style=display:flex><span>  $ sudo nvme amzn stats /dev/nvme1n1 -o json
</span></span></code></pre></div><p>The following output (without the -o json parameter) shows cumulative read/write operations, read/write bytes, total processing time (read and write in microseconds), and duration (in microseconds) when application attempted to exceed the instance’s IOPS/throughput limits.</p><p><img src=/images/blog-2/image-3.png></p><p>It also displays read/write I/O latency histograms, with each row representing completed I/O operations within a specific bin of time (in microseconds).</p><p><img src=/images/blog-2/image-4-1.png>
<img src=/images/blog-2/image-4-2.png></p><p>If you want to view the latency histograms across 5 different IO bands: (0, 512 Byte], (512B, 4KiB], (4KiB, 8KiB], (8KiB 32KiB], (32 KiB, MAX], you can provide <code>--details</code> or <code>-d</code> parameter to the command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  bash
</span></span><span style=display:flex><span>  $ sudo nvme amzn stats -d /dev/nvme1n
</span></span></code></pre></div><p>The following image is an excerpt of the above command’s output, showing the additional latency histograms (read and write) of the 5 different IO bands.</p><p><img src=/images/blog-2/image-5-1.png>
<img src=/images/blog-2/image-5-2.png>
<img src=/images/blog-2/image-5-3.png>
<img src=/images/blog-2/image-5-4.png>
<img src=/images/blog-2/image-5-5.png></p><p>You can run the stats command at a per second granularity. You can also write scripts to pull the stats at a desired interval (every second or any other duration) with each subsequent output reflecting the updated cumulative totals for the metrics. Calculating the difference in the statistics across the last two outputs allows you to derive insight into the instance storage profile during the interval. Below is a sample script you can use to pull the stats at a default interval of 1 second or at your desired interval.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>  <span style=color:#75715e>#!/bin/bash </span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># interval of 1 second </span>
</span></span><span style=display:flex><span>  INTERVAL<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>1<span style=color:#66d9ef>:-</span>1<span style=color:#e6db74>}</span> 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> true; <span style=color:#66d9ef>do</span> 
</span></span><span style=display:flex><span>	echo <span style=color:#e6db74>&#34;=== </span><span style=color:#66d9ef>$(</span>date<span style=color:#66d9ef>)</span><span style=color:#e6db74> ===&#34;</span> 
</span></span><span style=display:flex><span>	sudo nvme amzn stats /dev/nvme1 <span style=color:#f92672>||</span> break 
</span></span><span style=display:flex><span>	echo 
</span></span><span style=display:flex><span>	sleep $INTERVAL 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>You can save this script, make it executable and run it at either the default 1-second interval or provide a custom interval when executing the script. For example, if you saved the script as <code>nvme_stats.sh</code>,
you could use the following commands to make it executable and run to get the output at the default 1-second interval (assuming you are in the same directory as that of nvme_stats.sh).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  chmod +x nvme_stats.sh
</span></span><span style=display:flex><span>  ./nvme_stats.sh
</span></span></code></pre></div><p>If, for instance, you want to get the output at every 5 seconds, you can use the command below (after making the script executable)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>  ./nvme_stats.sh 5
</span></span></code></pre></div><p>You can also integrate with CloudWatch using CloudWatch agent to collect and publish these statistics for historical tracking, trend visualization through dashboards, and performance-based alerts to correlate with application metrics and automated notifications for performance issues.</p><h2 id=deriving-insights-from-the-amazon-ec2-instance-store-nvme-detailed-performance-statistics>Deriving insights from the Amazon EC2 instance store NVMe detailed performance statistics</h2><p>Similar to <a href=https://aws.amazon.com/blogs/storage/uncover-new-performance-insights-using-amazon-ebs-detailed-performance-statistics/>EBS detailed performance statistics</a>, you can use Amazon EC2 instance store NVMe statistics to troubleshoot various workload performance issues. As mentioned in the preceding section,
you can also use the detailed statistics to view I/O latency histograms to observe the spread of I/O latency within the period. You can use the read/write operations and time spent statistics to calculate the average latency. The detailed statistics show the average latency at per-second granularity.</p><p>The next two example scenarios demonstrate key performance analysis using the statistics. In Scenario 1, we will use the <strong>EC2 Instance Local Storage Performance Exceeded (us)</strong> metric to check if I/O demands exceed instance storage capabilities, helping with instance right-sizing for sufficient I/O application performance.
In Scenario 2, we will use IO-size specific histograms (using <code>--details</code>) to diagnose how large block writes affect subsequent read performance – an issue typically hidden by traditional monitoring tools’ aggregated metrics across all IO sizes.</p><h3 id=scenario-1-identifying-when-applications-exceed-instance-storage-performance-limits>Scenario 1: Identifying when applications exceed instance storage performance limits</h3><p>Understanding whether your application’s I/O demands exceed your instance store volumes’ capabilities is important for performance troubleshooting.
When applications generate I/O workloads that consistently attempt to exceed the IOPS and throughput limits of specific Amazon EC2 instance types, you’ll experience increased latency and degraded performance.
<strong>The EC2 Instance Local Storage Performance Exceeded (us)</strong> metric helps identify these scenarios by showing the duration (in microseconds) when workloads exceeded supported instance performance. A non-zero value or increasing count between snapshots indicates your current instance size or type may not provide sufficient I/O performance for your application.</p><p>The following section shows how to identify if an application is sending more IOPS than the instance’s local storage can support.</p><p>The example scenario: An application on an i3en.xlarge instance shows elevated write latency of >1ms. You want to determine if the application’s workload is exceeding the instance’s NVMe volume supported performance.</p><ol><li><strong>Select the Instance Storage NVMe device you want to analyze</strong> – Identify the instance you want to analyze for the application experiencing elevated latency.</li><li><strong>Identify the NVMe device</strong> – Use the following nvme-cli command, and identify the NVMe device associated with that instance storage.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>  $ sudo nvme list
</span></span></code></pre></div><p>Example scenario: We used the list and identified /dev/nvme1n1 as the NVMe device associated with the i3en.xlarge instance that is running the application which is currently seeing elevated write latency >1ms
(while read latency is &lt;50us as per normal conditions), so now we want to. analyze it.</p><ol start=3><li><strong>Collect statistics for the device at a single point in time or at desired intervals</strong> – Collect the detailed performance statistics using the nvme-cli command or use the sample script provided
in previous section to capture statistics at the desired intervals, if needed.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>  $ sudo nvme amzn stats /dev/nvme1n1
</span></span></code></pre></div><p>Example scenario: We choose to collect the statistics only once after noticing elevated write latency of the application.</p><ol start=4><li>Analyze the statistics to check if the application demands more than the supported performance of the instance storage – Confirm existence of overall I/O latency degradation by comparing two sets of read/write I/O latency histograms taken some time apart.Example scenario: The following output shows Read IO histogram of the NVMe local instance storage taken 40 seconds apart with no read IO latency issues (as normal read latency for this workload is &lt; 50 us).</li></ol><p>Metric captured at time T:</p><p><img src=/images/blog-2/image-6.png></p><p>Metric captured at time T+40s:</p><p><img src=/images/blog-2/image-7.png></p><p>The following output shows Write IO histogram taken 40 seconds apart. We can discern that many write IOs fall into the 1ms – 2ms latency range, which is not expected for this application.</p><p>Metric captured at time T:</p><p><img src=/images/blog-2/image-8.png></p><p>Metric captured at time T+40s:</p><p><img src=/images/blog-2/image-9.png></p><ol start=5><li>Analyze the <strong>EC2 Instance Local Storage Performance Exceeded (us)</strong> metric which shows total time (in microseconds) IOPS requests exceed volume limits. Ideally, the incremental count of this metric between two snapshot times should be minimal, as any value above 0 indicates that the workload demanded more IOPS than the volume could deliver.Example scenario: Comparing metrics 40 seconds apart shows that for more than 34 seconds, the application’s IOPS demands surpassed the IOPS
supported by the local instance storage. This explains elevated write latency: excess IOPS above what the underlying storage can physically handle queue the operations, increasing wait times. This indicates that the i3en.xlarge instance chosen to run this application cannot meet the application’s performance requirements, suggesting either upgrading to a larger instance size or re-evaluating the instance type itself.</li></ol><p>Metric captured at time T:</p><p><img src=/images/blog-2/image-10.png></p><p>Metric captured at time T+40s:</p><p><img src=/images/blog-2/image-11.png></p><p>It’s important to have the right instance size to avoid performance bottlenecks to your application. Refer to the <a href=https://aws.amazon.com/ec2/instance-types/>Amazon EC2 instance documentation</a> for more information on the different instances and their storage size.</p><h3 id=scenario-2-identifying-the-block-size-causing-elevated-latency-in-your-applications>Scenario 2: Identifying the block size causing elevated latency in your applications</h3><p>Many storage performance issues arise from complex interactions between read and write operations with different I/O sizes, which traditional system-level monitoring tools like <code>iostat</code> or <code>sar</code> cannot effectively diagnose due to their aggregated metrics across all I/O sizes.
EC2 instance store NVMe detailed performance statistics solves this by providing I/O-size specific latency histograms through the <code>--details</code> option in NVMe CLI.
These histograms show latency data for different I/O size ranges: (0, 512 Byte], (512B, 4KiB], (4KiB, 8KiB], (8KiB, 32KiB], (32KiB, MAX], for a more precise correlation between application workload patterns and I/O size-specific latency metrics for targeted optimizations.</p><p>In this example scenario, your application performs small reads (typically &lt;=4KiB, like metadata read) followed by large writes (>=32KiB) and shows unexpectedly high read latency. This common issue occurs when large writes impact subsequent read operations’ performance, creating a cascading effect on overall I/O performance.</p><ol><li><strong>Gather read and write IO latency by size ranges</strong> – Use the NVMe CLI with the <code>--details</code> option to gather read and write IO latency by size ranges:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    $ sudo nvme amzn stats /dev/nvme1n1 --details
</span></span></code></pre></div><ol start=2><li><strong>Confirm existence of overall IO latency degradation</strong> – In the example scenario, examining overall IO latency, both read (left) and write (right) operations are showing higher than expected latency.</li></ol><p><img src=/images/blog-2/image-12-1.png>
<img src=/images/blog-2/image-12-2.png></p><ol start=3><li><strong>Examine the output for patterns across different IO size bands</strong> – Analyzing latency by operation sizes shows small read operations (512 bytes to 4K), typically fast, are experiencing unexpected latency spikes while large
writes (32K+) show significant delays. Small reads should theoretically maintain good performance regardless of other I/O activities.</li></ol><p><img src=/images/blog-2/image-13-1.png>
<img src=/images/blog-2/image-13-1.png></p><p>The observed pattern indicates that the backed-up large write operations create system-wide congestion, affecting all I/O operations of types and sizes.
Despite the storage system’s capability to handle small reads efficiently, the queued large writes slow down both read and write operations at the application level.</p><p>Based on this analysis, we can implement several targeted optimizations to the application, like using smaller block sizes for write operations when possible,
or batching smaller writes instead of performing large single writes.</p><h2 id=clean-up>Clean up</h2><p>If you created an Amazon EC2 instance with NVMe volume for this exercise, then terminate and delete the appropriate instance to avoid future costs.</p><h2 id=conclusion>Conclusion</h2><p><a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/nvme-detailed-performance-stats.html>Amazon EC2 detailed performance statistics for instance store</a> NVMe volumes provide real-time, sub-minute storage performance monitoring, similar to the <a href=https://docs.aws.amazon.com/ebs/latest/userguide/nvme-detailed-performance-stats.html>detailed performance statistics available for Amazon EBS volumes</a>. This offers consistent monitoring experience
across both storage types, with additional IO-size based latency histograms for instance storage for better optimization of I/O patterns, and more effective troubleshooting.</p><p>To learn more about Amazon EC2 instance store NVMe volumes, optimization techniques for latency-sensitive workloads or other Amazon EC2 related topics, visit the <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html>Amazon EC2 documentation page</a> or explore our other AWS Storage Blog posts on performance optimization.</p><p>We’d love to hear how you’re using these statistics to enhance your workloads, or if you have any questions, in the comments section below.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/3-blogstranslated/3.1-blog1/ title="Blog 1"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/3-blogstranslated/3.3-blog3/ title="Blog 3" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1765329835></script><script src=/js/perfect-scrollbar.min.js?1765329835></script><script src=/js/perfect-scrollbar.jquery.min.js?1765329835></script><script src=/js/jquery.sticky.js?1765329835></script><script src=/js/featherlight.min.js?1765329835></script><script src=/js/highlight.pack.js?1765329835></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1765329835></script><script src=/js/learn.js?1765329835></script><script src=/js/hugo-learn.js?1765329835></script><link href=/mermaid/mermaid.css?1765329835 rel=stylesheet><script src=/mermaid/mermaid.js?1765329835></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>